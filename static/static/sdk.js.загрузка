!function(s,o){function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e,r){var n=new Date;n.setTime(n.getTime()+31536e7);var t="expires="+n.toUTCString();o.cookie=e+"="+r+";"+t+";domain="+function(){var e=location.hostname;return 2<location.hostname.split(".").length&&(e=location.hostname.split(".").reverse().slice(0,2).reverse().join("."),~a.indexOf(e)&&(e=location.hostname.split(".").reverse().slice(0,3).reverse().join("."))),e}()+";path=/"}var i={},c={isInitialized:!1,apiUrl:null},a=["msk.ru","com.br"];function p(){if(c.customUserId)return e=function(e,r){for(var n=e;n.length<r;)n+="0";return n}(c.customUserId.replace(/\D/g,""),32);var e,r="iap.uid";return(e=function(e){for(var r=e+"=",n=o.cookie.split(";"),t=0;t<n.length;t++){for(var i=n[t];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(r))return i.substring(r.length,i.length)}return""}(r))&&32===e.length||(e=(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/1|0/g,function(){return(0|16*Math.random()).toString(16)}).replace(/-/g,""),n(r,e)),e}function u(e,r,n){r.push("uid="+p());var t=[c.apiUrl,e,"?",r.join("&")].join("");if(s.navigator.sendBeacon){var i=new Blob([JSON.stringify(n||{})],{type:"text/plain"});s.navigator.sendBeacon(t,i)}else{var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/json"),o.withCredentials=!0;var a=JSON.stringify(n);o.send(a)}}if(i.push=function(e){try{if(!t(e))throw new TypeError("iapSDK: Push item is not array");var r=e[0],n=e[1];if("function"!=typeof i[r]||"push"===r)throw new ReferenceError("iapSDK: Not found method "+r);i[r](n)}catch(e){console.error(e.message)}},i.init=function(e){if(!(e=e||{}).apiUrl)throw new TypeError("iapSDK: Init must set api url");if(c.isInitialized)throw new Error("iapSDK: SDK already init");c.isInitialized=!0,c.apiUrl=e.apiUrl,c.customUserId=e.customUserId,e.disableAutoHit||i.hit()},i.hit=function(){var e=encodeURIComponent(o.URL),r=encodeURIComponent(o.referrer);u("/tracker/hit",["url="+e,"ref="+r,"sw="+s.screen.width,"sh="+s.screen.height,"rnd="+Math.random()])},i.event=function(e){!function(){if(!c.isInitialized)throw new ReferenceError("iapSDK: SKD not initialized")}();var r={ADD_TO_CART:1,CONFIRM_ATTRIBUTION:2};if(!r[e.event])throw new TypeError("iapSDK: Unknown event type "+e.event);e.data||(e.data={}),e.event=r[e.event],u("/tracker/event",[],{event:e.event,data:e.data})},i.order=function(e){if(!e)throw new ReferenceError("iapSDK: order object undefined");u("/tracker/order",[],e)},i.conversion=function(e){if(!e)throw new ReferenceError("iapSDK: conversion object undefined");if("lead"===e.type){var r={};e.category&&(r.category=e.category),e.brand&&(r.brand=e.brand),e={id:e.id+"",type:e.type,offerAlias:e.offerAlias,coupon:e.coupon,isNewCustomer:e.isNewCustomer,items:[r]}}u("/tracker/conversion",[],e)},s.iapSDK&&t(s.iapSDK))for(var e=0;e<s.iapSDK.length;e++)i.push(s.iapSDK[e]);s.iapSDK=i}(window,document);