(window.webpackJsonp=window.webpackJsonp||[]).push([[410],{944:function(t,e,i){"use strict";i.r(e);var s=i(36),n=i.n(s),a=i(2),l=i.n(a),o=i(3),d=i(202),g=i(56),m=i(150),r=n.a.Model.extend({defaults:{selected:!1}}),h=n.a.Collection.extend({model:r}),c=n.a.Collection.extend({model:r,filterBy:function(t,e){var i=this.filter((function(i){return i.get(t)===e}));return new c(i)}});function u(t,e){this.$element=l()(t),this.element=t,this.params=e,this.init=function(){var t=this;this.$add=l()(".HH-Tags-Add",this.$element),this.$input=l()(".HH-Tags-Input",this.$element),this.$output=l()(".HH-Tags-Output",this.$element),this.$recommendation=l()(".HH-Tags-Recommendation",this.$element),this.skillsCollection=new h,this.recommendedSkillsCollection=new c,l()(".Bloko-TagList-Tag",this.$output).each((function(e,i){var s=l()(i),n=s.attr("data-tag-id"),a=l()(".Bloko-TagList-Value",i),o=n.trim();n.length>o.length&&(n=o,i.setAttribute("data-tag-id",o),a.val(a.val().trim()));var d=t.resolveTagData(n,t.getTagText(s));d.name&&(i.setAttribute("data-tag-id",d.id),t.skillsCollection.add(new r({id:d.id,name:d.name,selected:!0}),{silent:!0}))})),this.tagList=m.a.create(this.$output,{removable:!0,hiddenFieldName:this.params.hiddenFieldName}),this.recommendationTagList=m.a.create(this.$recommendation,{selectable:!0}),this.tagList.initTags(),this.tagList.on("Bloko-TagList-Removed",(function(e){t.skillsCollection.get(t.resolveTagData(e.id,e.text).id)&&t.removeTag(e.id,e.text)})),this.suggestVisible=!1,this.recommendedSkillsCollection.on("updateAllRecommended",(function(){var e=t.recommendedSkillsCollection.filterBy("selected",!1).models.map((function(e){var i=t.resolveTagData(e.get("id"),e.get("name"));return{id:i.id,text:i.name,hiddenValue:i.id,selected:!!t.skillsCollection.get(e.id),animated:!1}}));t.recommendationTagList.add(e)})),this.recommendedSkillsCollection.on("tags.show",(function(e){var i=e.get("id");t.recommendationTagList.add({id:i,text:e.get("name"),hiddenValue:i,animated:!1})})),this.recommendedSkillsCollection.on("tags.hide",(function(e){t.recommendationTagList.remove(e.get("id"))})),this.updateRecommendations(),this.$input.attr("maxlength",this.params.maxLength),this.$input.on("selected.suggest",(function(e,i){t.addTag(i.id,i.text)})).on("hid.suggest",(function(){t.suggestVisible=!1})).on("showed.suggest",(function(){t.suggestVisible=!0})).on("HH-Tags-UpdateRecommendations",this.updateRecommendations.bind(this)).on("blur",(function(e){t.suggestVisible||e.relatedTarget&&e.relatedTarget===t.$add.get(0)||t.addTag(t.$input.val(),t.$input.val())})).on("valuechange",this.setDisabledAttr.bind(this)),this.params.onlyExisting||this.$input.on("keydown",(function(e){t.suggestVisible||e.keyCode!==d.default.ENTER||(e.preventDefault(),t.addTag(t.$input.val(),t.$input.val()))})),this.$add.on("click",(function(){t.addTag(t.$input.val(),t.$input.val())})).on("blur",(function(e){t.suggestVisible||e.relatedTarget&&e.relatedTarget===t.$input.get(0)||t.addTag(t.$input.val(),t.$input.val())})),this.skillsCollection.on("add remove",(function(){t.$output.toggleClass("g-hidden",0===t.skillsCollection.length),t.setDisabledAttr()})),this.recommendationTagList.on("Bloko-TagList-ToggleSelected",(function(e){e.selected?t.addTag(e.id,e.text):t.removeTag(e.id,e.text)})),g.default.add("HH-Tags-Collections",(function(e){e(t.skillsCollection,t.recommendedSkillsCollection)}),this.element),this.$output.toggleClass("g-hidden",0===this.skillsCollection.length),this.setDisabledAttr()},this.updateRecommendations=function(){var t=this;this.recommendedSkillsCollection.reset(),l()(".Bloko-TagList-Tag",this.$recommendation).each((function(e,i){var s=t.resolveTagData(l()(i).data("tag-id"),t.getTagText(l()(i))),n=new r({id:s.id,name:s.name});t.recommendedSkillsCollection.add(n,{silent:!0})})),this.recommendedSkillsCollection.set(this.skillsCollection.models,{add:!1,remove:!1,merge:!0})},this.addTag=function(t,e){var i=this.resolveTagData(t,e),s=i.id,n=i.name;if(!(n.length>this.params.maxLength||n.length<this.params.minLength||this.skillsCollection.length>=this.params.maxCount)){var a=new r({id:s,name:n,selected:!0}),o=this.skillsCollection.length;this.skillsCollection.add(a,{merge:!0}),this.recommendedSkillsCollection.set(a,{add:!1,remove:!1,merge:!0}),this.recommendationTagList.toggleSelect(s,!0),this.tagList.add([{id:s,text:n,hiddenValue:this.params.useNameAsId?n:s}]),o!==this.skillsCollection.length&&this.skillsCollection.trigger("tags.select",l()(this.tagList.getTagElement(s)).find("input").get(0)),this.$input.val(""),this.setDisabledAttr()}},this.removeTag=function(t,e){var i=this.resolveTagData(t,e).id;this.skillsCollection.remove({id:i});var s=new this.recommendedSkillsCollection.model({id:i,name:e,selected:!1});this.recommendedSkillsCollection.set(s,{add:!1,remove:!1,merge:!0}),this.skillsCollection.trigger("tags.deselect",e),this.tagList.remove(i),this.recommendationTagList.toggleSelect(i,!1)},this.setDisabledAttr=function(){var t=""===this.$input.val().trim()||this.skillsCollection.length>=this.params.maxCount;this.$add.prop("disabled",t)},this.resolveTagData=function(t,e){return t=this.toLowerCase(t.toString().trim()),e=e.trim(),this.params.useNameAsId&&(t=this.toLowerCase(e)),{id:t,name:e}},this.toLowerCase=function(t){return this.params.lowerCaseId?t.toLowerCase():t},this.getTagText=function(t){return t.find(".Bloko-TagList-Text").text()},this.init(t,e)}e.default=o.default.build({defaults:{minLength:1,maxLength:100,maxCount:20,useNameAsId:!0,onlyExisting:!1,lowerCaseId:!0},create:function(t,e){return new u(t,e)},componentName:"HH/KeySkills/Tags"})}}]);
//# sourceMappingURL=410.dff4ffcd685b932cf019.js.map